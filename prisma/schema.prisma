
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}
        

// 用户表 - 独立的表，不与文章表关联
model User {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  username   String   @unique @db.VarChar(255)
  password   String   @db.VarChar(255)  // 存储加密后的密码
  created_at DateTime @default(now()) @db.Timestamptz(6)
}

// 文章表
model Article {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title      String   @db.VarChar(255)
  status     String   @default("draft") @db.VarChar(50)  // draft, published, archived
  content    String
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @updatedAt @db.Timestamptz(6)
 
  // 多对多关系：文章可以有多个标签，标签可以属于多篇文章
  tags Tag[] @relation("ArticleToTag")
}

// 标签表
model Tag {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name       String   @unique @db.VarChar(100)
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @updatedAt @db.Timestamptz(6)

  // 多对多关系：标签可以属于多篇文章，文章可以有多个标签
  articles Article[] @relation("ArticleToTag")
}